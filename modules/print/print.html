<html>
	<head>
		<link rel="stylesheet" type="text/css" href="../../tools/jquery/css/smoothness/jquery-ui.css"/>
		<script src="../../tools/jquery/js/jquery-1.9.1.js"></script>
		<script src="../../tools/jquery/js/jquery-ui.js"></script>
		<script src="../../tools/OpenLayers/OpenLayers.js"></script>
		<style>
			.olImageLoadError{display: none !important;}
			html, body{
				height:100%;
				margin:0px;
				padding:0px;
			}
		</style>
		<script>
			
			var p=parent;
			var map;
			
			function createMap()
			{
				OpenLayers.IMAGE_RELOAD_ATTEMPTS = 5;
				OpenLayers.DOTS_PER_INCH = 25.4 / 0.28;
				OpenLayers.Util.onImageLoadErrorColor = 'transparent';
				
				map = new OpenLayers.Map("map", {controls: []});
				
				
				map.addControl(new OpenLayers.Control.Navigation());
	
				var _map_config_object=p._config_init_map();
				
				var overlayers=p.map.getLayersBy("isBaseLayer",true);
				
				for(var i=(overlayers.length-1);i>=0;i--)
				{
					if(overlayers[i].getVisibility())
					{
						map.addLayer(overlayers[i].clone());
					}
				}
				
				addLayers("");
				
				map.setCenter(new OpenLayers.LonLat(Number(p.map.getCenter().lon),Number(p.map.getCenter().lat)),p.map.getZoom());
				
				populateInputs();
			}
			
			function addLayers(featureid)
			{
				var overlayers=p.mapGetlayersBy("isBaseLayer",false);

				for(var i=0;i<overlayers.length;i++)
				{
					if (typeof overlayers[i]._layerObject!=="undefined")
					{
						if (overlayers[i]._layerObject._isPrintable)
						{
							var _layer=overlayers[i].clone();
							
							map.addLayer(_layer);
						}
					}
				}
			}
			
			function populateInputs()
			{
				
				if(p.print_template._print_logo){$("#logo").html(p.print_template._print_logo)};
				
				if(p.print_template._print_title){$("#title").html(p.print_template._print_title)};
				
				if(p.print_template._print_abstract){$("#abstract").html(p.print_template._print_abstract)};
			
			}
			
			function createCode()
			{
				return $("#container").html();
			}
		
		</script>
	</head>
	<body onload="createMap();">
		<div id="container">
			<div style="width:210mm;height:297mm;margin-left:auto;margin-right:auto;">
				<div id="logo"></div>
				<div id="title"></div>
				<div id="map" style="position:relative;width:100%;height:80% !important;overflow:hidden;"></div>
				<div id="abstract"></div>
			</div>
		</div>
	</body>
</html>